---
data:
  _extendedDependsOn:
  - icon: ':question:'
    path: mod/crt3.hpp
    title: mod/crt3.hpp
  - icon: ':question:'
    path: mod/mod_inv.hpp
    title: mod/mod_inv.hpp
  - icon: ':question:'
    path: mod/modint.hpp
    title: mod/modint.hpp
  - icon: ':question:'
    path: mod/modint_common.hpp
    title: mod/modint_common.hpp
  - icon: ':question:'
    path: my_template.hpp
    title: my_template.hpp
  - icon: ':question:'
    path: other/io.hpp
    title: other/io.hpp
  - icon: ':question:'
    path: poly/convolution.hpp
    title: poly/convolution.hpp
  - icon: ':question:'
    path: poly/convolution_karatsuba.hpp
    title: poly/convolution_karatsuba.hpp
  - icon: ':question:'
    path: poly/convolution_naive.hpp
    title: poly/convolution_naive.hpp
  - icon: ':question:'
    path: poly/ntt.hpp
    title: poly/ntt.hpp
  - icon: ':x:'
    path: poly/online/online_square.hpp
    title: poly/online/online_square.hpp
  _extendedRequiredBy: []
  _extendedVerifiedWith: []
  _isVerificationFailed: true
  _pathExtension: cpp
  _verificationStatusIcon: ':x:'
  attributes:
    '*NOT_SPECIAL_COMMENTS*': ''
    PROBLEM: https://yukicoder.me/problems/no/2801
    links:
    - https://yukicoder.me/problems/no/2801
  bundledCode: "Traceback (most recent call last):\n  File \"/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/onlinejudge_verify/documentation/build.py\"\
    , line 71, in _render_source_code_stat\n    bundled_code = language.bundle(stat.path,\
    \ basedir=basedir, options={'include_paths': [basedir]}).decode()\n          \
    \         ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\
    \  File \"/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/onlinejudge_verify/languages/cplusplus.py\"\
    , line 187, in bundle\n    bundler.update(path)\n    ~~~~~~~~~~~~~~^^^^^^\n  File\
    \ \"/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/onlinejudge_verify/languages/cplusplus_bundle.py\"\
    , line 401, in update\n    self.update(self._resolve(pathlib.Path(included), included_from=path))\n\
    \    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\
    \  File \"/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/onlinejudge_verify/languages/cplusplus_bundle.py\"\
    , line 289, in update\n    uncommented_lines = get_uncommented_code(path, iquotes=self.iquotes,\
    \ compiler=self.compiler).splitlines(keepends=True)\n                        ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\
    \  File \"/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/onlinejudge_verify/languages/cplusplus_bundle.py\"\
    , line 195, in get_uncommented_code\n    code = _get_uncommented_code(path.resolve(),\
    \ iquotes_options=tuple(iquotes_options), compiler=compiler)\n  File \"/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/onlinejudge_verify/languages/cplusplus_bundle.py\"\
    , line 188, in _get_uncommented_code\n    return subprocess.check_output(command)\n\
    \           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/subprocess.py\"\
    , line 472, in check_output\n    return run(*popenargs, stdout=PIPE, timeout=timeout,\
    \ check=True,\n           ~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\
    \               **kwargs).stdout\n               ^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/subprocess.py\"\
    , line 577, in run\n    raise CalledProcessError(retcode, process.args,\n    \
    \                         output=stdout, stderr=stderr)\nsubprocess.CalledProcessError:\
    \ Command '['g++', '-x', 'c++', '-I', '/home/runner/work/library/library', '-fpreprocessed',\
    \ '-dD', '-E', '/home/runner/work/library/library/other/io.hpp']' returned non-zero\
    \ exit status 1.\n"
  code: "#define PROBLEM \"https://yukicoder.me/problems/no/2801\"\n\n#include \"\
    my_template.hpp\"\n#include \"other/io.hpp\"\n\n#include \"mod/modint.hpp\"\n\
    #include \"poly/convolution.hpp\"\n#include \"poly/online/online_square.hpp\"\n\
    \n/*\n\u3059\u3054\u3044.\n\nF(x) = x + Mx^2 + O(x^3) \u3067\u3042\u3063\u3066\
    \nF(x+x^2)=F(x)+F(x)^2\n\u3092\u6E80\u305F\u3059\u3082\u306E\u3092\u6C42\u3081\
    \u308B\n\nF(x)=xG(x)\n(x+x^2)G(x+x^2)=xG(x)+x^2G(x)^2\n\n(1+x)G(x+x^2)=G(x)+xG(x)^2\n\
    \n[x^{n+1}]\nLHS: G[n+1] + (n+1)G[n] + (G[0], ..., G[n-1])\nRHS: G[n+1] + 2G[n]\
    \ + ...\n\nH(x):=G(x+x^2)\n\nG(x)=1+xA(x)\nG(x)^2=1+2xA(x)+x^2A(x)^2\n*/\n\nusing\
    \ mint = modint998;\n\nvoid solve() {\n  LL(N, M);\n  ++N;\n\n  Online_Square<mint>\
    \ SQ;\n\n  vc<mint> G(N + 1);\n  vc<mint> A(N);\n  vc<mint> AA(N);\n\n  vc<mint>\
    \ H(N + 1);\n\n  auto dfs = [&](auto& dfs, int L, int R) -> vc<mint> {\n    /*\n\
    \    return: sum G[i](x+x^2)^{i-L}\n    dfs call \u306E\u6642\u70B9\u3067\u3001\
    G[0:L) \u306E H[L+1:R+1) \u3078\u306E\u5BC4\u4E0E\u306F\u8A08\u7B97\u6E08\u3067\
    \u3042\u308B\u3088\u3046\u306B\u3059\u308B\n    */\n    if (R == L + 1) {\n  \
    \    mint ans = [&]() -> mint {\n        if (L == 0) return 1;\n        if (L\
    \ == 1) return M;\n        // (1+x)H(x)=G(x)+xG(x)^2\n        // [x^{L+1}]x(1+xA)^2\n\
    \        mint lhs = H[L + 1] + H[L];\n        mint rhs = AA[L - 2];\n        if\
    \ (L == 2) SHOW(lhs, rhs);\n        return (rhs - lhs) * inv<mint>(L - 1);\n \
    \     }();\n      G[L] = ans;\n      H[L] += ans;\n      H[L + 1] += mint(L) *\
    \ ans;\n      if (L > 0) A[L - 1] = ans, AA[L - 1] = SQ.query(L - 1, A[L - 1]);\n\
    \      return {ans};\n    }\n    int M = (L + R) / 2;\n    vc<mint> f = dfs(dfs,\
    \ L, M);\n    // f(x)(x+x^2)^L \u3092 [M+1,R+1) \u306B\u53CD\u6620\u3055\u305B\
    \u308B\n    // [M-L+1,R-L+1) of f(x)(1+x)^L\n    {\n      vc<mint> g(R - L + 1);\n\
    \      FOR(i, R - L + 1) g[i] = C<mint>(L, i);\n      g = convolution<mint>(f,\
    \ g);\n      g = {g.begin() + (M - L + 1), g.end()};\n      FOR(i, M + 1, R +\
    \ 1) { H[i] += g[i - (M + 1)]; }\n      SHOW(L, M, R, g);\n    }\n    vc<mint>\
    \ g = dfs(dfs, M, R);\n    // f(x) <- f(x) + g(x)(x+x^2)^{M-L}\n    vc<mint> h(2\
    \ * (M - L) + 1);\n    FOR(i, M - L + 1) h[M - L + i] = C<mint>(M - L, i);\n \
    \   g = convolution<mint>(g, h);\n    if (len(f) < len(g)) swap(f, g);\n    FOR(i,\
    \ len(g)) f[i] += g[i];\n    return f;\n  };\n  dfs(dfs, 0, N);\n  print(G[N -\
    \ 1]);\n}\n\nsigned main() {\n  solve();\n  return 0;\n}\n"
  dependsOn:
  - my_template.hpp
  - other/io.hpp
  - mod/modint.hpp
  - mod/modint_common.hpp
  - poly/convolution.hpp
  - mod/mod_inv.hpp
  - mod/crt3.hpp
  - poly/convolution_naive.hpp
  - poly/convolution_karatsuba.hpp
  - poly/ntt.hpp
  - poly/online/online_square.hpp
  isVerificationFile: true
  path: test/3_yukicoder/2801.test.cpp
  requiredBy: []
  timestamp: '2025-09-01 20:17:42+09:00'
  verificationStatus: TEST_WRONG_ANSWER
  verifiedWith: []
documentation_of: test/3_yukicoder/2801.test.cpp
layout: document
redirect_from:
- /verify/test/3_yukicoder/2801.test.cpp
- /verify/test/3_yukicoder/2801.test.cpp.html
title: test/3_yukicoder/2801.test.cpp
---
